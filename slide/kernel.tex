\documentclass[10pt, compress]{beamer}

\usetheme[titleprogressbar]{m}

\usepackage{booktabs}
\usepackage[scale=2]{ccicons}
\usepackage{minted}

\usepgfplotslibrary{dateplot}

\usemintedstyle{trac}

\title{Kernel Methods}
\subtitle{}
\date{\today}
\author{Chih-Wei Chang \and Chung-Yen Hung}
\institute{Department of Mathematics, National Taiwan University}

\begin{document}

\maketitle

\section{Introduction}

\begin{frame}[fragile]
  \frametitle{Motivation}

  \begin{block}{Linear Model}
    \begin{enumerate}
      \item Simple and Well Studied
      \item Computationally Feasible
    \end{enumerate}
  \end{block}

  \begin{block}{Real-world Problems}
    \begin{enumerate}
      \item Non Linear
      \item Sophisticated Interdependencies
    \end{enumerate}
  \end{block}

  \begin{description}
    \item[Question] Can we apply \textbf{Linear Model} on \textbf{Real-world Problems}?
  \end{description}

\end{frame}

\begin{frame}[fragile]
  \frametitle{Motivation Cont.}

  \begin{block}{How about \textbf{Feature Transform}?}
    Mapping features to higher dimensional space. For example, the quadratic transformation from \(\mathbb{R}^2\) to \(\mathbb{R}^6\)
    \[
      \Phi: (x_1, x_2) \mapsto (x_1^2, x_2^2, \sqrt{2} x_1 x_2, \sqrt{2} x_1, \sqrt{2} x_2, 1).
    \]

    Line in \(\mathbb{R}^6\) corresponds to quadratic curve in \(\mathbb{R}^2\).
    Common techniques in the machine learning world.

    \begin{description}[<+- | alert@+>]
      \item[Learning Stage] Fit linear model \(h: \mathbb{R}^6 \rightarrow \{0, 1\} \) on \(\Phi(\mathbf{x})\).
      \item[Testing Stage] \(h(\Phi(\mathbf{x}_{test}))\) gives the prediction.
    \end{description}

  \end{block}

\end{frame}

\begin{frame}[fragile]{Motivation Cont.}

  However \dots
  \begin{description}[<+- | alert@+>]
    \item[Pros] Fitting complicated underlying rules -- the higher the dimension, the more powerful the model.
    \item[Cons] Extra computational costs, e.g., inner products -- the higher the dimension, the harder the computation.
  \end{description}
\end{frame}


\begin{frame}[fragile]{Kernel Trick}

  Luckily, \textbf{Kernel Trick} comes to rescue \dots
  \begin{enumerate}[<+- | alert@+>]
    \item Mathematical shortcut for preventing computing inner product directly.
    \item Combine the favors of Linearity and Non-Linearity.
  \end{enumerate}
\end{frame}

\begin{frame}[fragile]{Kernel Trick Cont.}

  \begin{block}{Kernel Trick}
    Consider the inner product in the previous example
    \begin{align*}
      \langle \Phi(\mathbf{x}), \Phi(\mathbf{y}) \rangle &= {\Phi(\mathbf{x})}^T \Phi(\mathbf{y}) \\
          &= x_1^2 y_1^2 + x_2^2 y_2^2 + 2 x_1 x_2 y_1 y_2 + 2 x_1 y_1 + 2 x_2 y_2 + 1 \\
          &= {(\mathbf{x}^T\mathbf{y} + 1)}^2 = {(\langle \mathbf{x}, \mathbf{y} \rangle + 1)}^2
    \end{align*}

    It implies we can define a special function
    \[
      K(\mathbf{x}_1, \mathbf{x_2}) = \langle \Phi(\mathbf{x_1}), \Phi(\mathbf{x_2}) \rangle,
    \]
    which is the so-called kernel function.

  \end{block}

\end{frame}

\section{Common Kernel}

\subsection{}

\begin{frame}[fragile]{Polynomial Kernel}

  \begin{block}{Polynomial Kernel}

    Suppose we use the polynomial feature transformation \( \Phi_{d}(x) \), which collects all the possible coefficients in the \(d\)-degree polynomial.

    We then have the polynomial kernel
    \[
      K_{\Phi_{d}}(x, y) = {(\langle x,y \rangle + \alpha)}^{d}
    \]
  \end{block}

\end{frame}

\begin{frame}[fragile]{Polynomial Kernel Cont.}

  \begin{block}{Quadratic Transformation as An Special Case}
    Let \( d=2 \), the transformation
    \begin{align*}
      \Phi_{2}(x) &= (x_{n}^{2}, \dots, x_{1}^{2}, \sqrt{2}x_{n}x_{n-1}, \\
                  &\dots, \sqrt{2}x_{n}x_{1}, \sqrt{2}x_{n-1}x_{n-2}, \dots, \\
                  &\sqrt{2c}x_{n}, \dots, \sqrt{2c}x_{1}, c)
    \end{align*}
    And the kernel function
    \begin{align*}
      K(x, y) &= (\sum_{i=1}^{n} x_{i}y_{i} + \alpha)^{2} = \sum_{i=1}^{n}(x_{i}^{2})(y_{i}^{2}) + \\
              &\sum_{i=2}^{n}\sum_{j=1}^{i-1}(\sqrt{2}x_{i}x_{j})(\sqrt{2}y_{i}y_{j}) + \sum_{i=1}^{n}(\sqrt{2c}x_{i})(\sqrt{2c}y_{i})
    \end{align*}
  \end{block}
\end{frame}


\begin{frame}[fragile]{Gaussian Kernel}

  \begin{block}{Gaussian Kernel}
    The Gaussian Kernel is defined as
    \[
      K(x, y) = \exp(-\gamma{\| x-y \|}^{2}), \text{with \( \gamma > 0\)}
    \]
  \end{block}

\end{frame}

\begin{frame}[fragile]{Gaussian Kernel Cont.}
  \begin{block}{As An Extreme Case of Polynomial Kernel}
    For \(\gamma = 1\)
    \begin{equation}
      \begin{split}
          K(x, y) &= \exp({\| x-y \|}^{2}) \\
                  &= \exp(-{(x)}^{2})\exp(-{(y)}^{2})\exp({(2xy)}) \\
                  &\stackrel{*}{=} \exp(-{(x)}^{2})\exp(-{(y)}^{2})(\sum_{i=0}^{\infty}\frac{{(2xy)}^{i}}{i!}) \\
                  &= \sum_{i=0}^{\infty}(\exp(-{(x)}^{2}\sqrt\frac{2^{i}}{i!}){(x)}^{i})(\exp(-{(y)}^{2}\sqrt\frac{2^{i}}{i!}){(y)}^{i}) \\
                  &= \Phi{(x)}^{T}\Phi(y)\\
      \end{split}
    \end{equation}
    It implies \(\Phi(x) = \exp(-{(x)}^{2})(1, \sqrt\frac{2}{1!}x, \sqrt\frac{2^{2}}{2!}x^{2}, \dots)\).
  \end{block}
\end{frame}



\section{Kernel Machines}
\section{Conclusion}

\begin{frame}[fragile]
  \frametitle{mtheme}

  The \emph{mtheme} is a Beamer theme with minimal visual noise inspired by the
  \href{https://github.com/hsrmbeamertheme/hsrmbeamertheme}{\textsc{hsrm} Beamer
  Theme} by Benjamin Weiss.

  Enable the theme by loading

  \begin{minted}[fontsize=\small]{latex}
    \documentclass{beamer}
    \usetheme{m}
  \end{minted}

  Note, that you have to have Mozilla's \emph{Fira Sans} font and XeTeX
  installed to enjoy this wonderful typography.
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sections}
  Sections group slides of the same topic

  \begin{minted}[fontsize=\small]{latex}
    \section{Elements}
  \end{minted}

  for which the \emph{mtheme} provides a nice progress indicator \ldots
\end{frame}

\section{Elements}

\begin{frame}[fragile]
  \frametitle{Typography}
      \begin{minted}[fontsize=\small]{latex}
The theme provides sensible defaults to \emph{emphasize}
text, \alert{accent} parts or show \textbf{bold} results.
      \end{minted}

  \begin{center}becomes\end{center}

  The theme provides sensible defaults to \emph{emphasize} text,
  \alert{accent} parts or show \textbf{bold} results.
\end{frame}
\begin{frame}{Lists}
  \begin{columns}[onlytextwidth]
    \column{0.5\textwidth}
      Items
      \begin{itemize}
        \item Milk \item Eggs \item Potatos
      \end{itemize}

    \column{0.5\textwidth}
      Enumerations
      \begin{enumerate}
        \item First, \item Second and \item Last.
      \end{enumerate}
  \end{columns}
\end{frame}
\begin{frame}{Descriptions}
  \begin{description}
    \item[PowerPoint] Meeh.
    \item[Beamer] Yeeeha.
  \end{description}
\end{frame}
\begin{frame}{Animation}
  \begin{itemize}[<+- | alert@+>]
    \item \alert<4>{This is\only<4>{ really} important}
    \item Now this
    \item And now this
  \end{itemize}
\end{frame}
\begin{frame}{Figures}
  \begin{figure}
    \newcounter{density}
    \setcounter{density}{20}
    \begin{tikzpicture}
      \def\couleur{mLightBrown}
      \path[coordinate] (0,0)  coordinate(A)
                  ++( 90:5cm) coordinate(B)
                  ++(0:5cm) coordinate(C)
                  ++(-90:5cm) coordinate(D);
      \draw[fill=\couleur!\thedensity] (A) -- (B) -- (C) --(D) -- cycle;
      \foreach \x in {1,...,40}{%
          \pgfmathsetcounter{density}{\thedensity+20}
          \setcounter{density}{\thedensity}
          \path[coordinate] coordinate(X) at (A){};
          \path[coordinate] (A) -- (B) coordinate[pos=.10](A)
                              -- (C) coordinate[pos=.10](B)
                              -- (D) coordinate[pos=.10](C)
                              -- (X) coordinate[pos=.10](D);
          \draw[fill=\couleur!\thedensity] (A)--(B)--(C)-- (D) -- cycle;
      }
    \end{tikzpicture}
    \caption{Rotated square from
    \href{http://www.texample.net/tikz/examples/rotated-polygons/}{texample.net}.}
  \end{figure}
\end{frame}
\begin{frame}{Tables}
  \begin{table}
    \caption{Largest cities in the world (source: Wikipedia)}
    \begin{tabular}{lr}
      \toprule
      City & Population\\
      \midrule
      Mexico City & 20,116,842\\
      Shanghai & 19,210,000\\
      Peking & 15,796,450\\
      Istanbul & 14,160,467\\
      \bottomrule
    \end{tabular}
  \end{table}
\end{frame}
\begin{frame}{Blocks}

  \begin{block}{This is a block title}
    This is soothing.
  \end{block}

\end{frame}
\begin{frame}{Math}
  \begin{equation*}
    e = \lim_{n\to \infty} \left(1 + \frac{1}{n}\right)^n
  \end{equation*}
\end{frame}
\begin{frame}{Line plots}
  \begin{figure}
    \begin{tikzpicture}
      \begin{axis}[
        mlineplot,
        width=0.9\textwidth,
        height=6cm,
      ]

        \addplot {sin(deg(x))};
        \addplot+[samples=100] {sin(deg(2*x))};

      \end{axis}
    \end{tikzpicture}
  \end{figure}
\end{frame}
\begin{frame}{Bar charts}
  \begin{figure}
    \begin{tikzpicture}
      \begin{axis}[
        mbarplot,
        xlabel={Foo},
        ylabel={Bar},
        width=0.9\textwidth,
        height=6cm,
      ]

      \addplot plot coordinates {(1, 20) (2, 25) (3, 22.4) (4, 12.4)};
      \addplot plot coordinates {(1, 18) (2, 24) (3, 23.5) (4, 13.2)};
      \addplot plot coordinates {(1, 10) (2, 19) (3, 25) (4, 15.2)};

      \legend{lorem, ipsum, dolor}

      \end{axis}
    \end{tikzpicture}
  \end{figure}
\end{frame}
\begin{frame}{Quotes}
  \begin{quote}
    Veni, Vidi, Vici
  \end{quote}
\end{frame}


\section{Conclusion}

\begin{frame}{Summary}

  Get the source of this theme and the demo presentation from

  \begin{center}\url{github.com/matze/mtheme}\end{center}

  The theme \emph{itself} is licensed under a
  \href{http://creativecommons.org/licenses/by-sa/4.0/}{Creative Commons
  Attribution-ShareAlike 4.0 International License}.

  \begin{center}\ccbysa\end{center}

\end{frame}

\plain{Questions?}

\end{document}
